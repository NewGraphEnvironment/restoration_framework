---
title: "Cottonwood Seed Transfer: Nechako Source to Mackenzie and Skeena Basins"
author: "Al Irvine, B.Sc., R.P.Bio. — New Graph Environment Ltd."
date: "`r format(Sys.Date(), '%Y-%m-%d')`"
output:
  bookdown::html_document2:
    theme: cosmo
    toc: true
    toc_float: true
    self_contained: true
bibliography: "`r rbbt::bbt_write_bib('references.bib', overwrite = TRUE)`"
biblio-style: apalike
link-citations: no
---

<style>
a { color: #333333; }
a:hover { color: #555555; }
.tocify a, .tocify .active { color: #000000 !important; }
.tocify .active a { color: #000000 !important; font-weight: bold; }
.tocify-header .active { background-color: #e8e8e8 !important; }
</style>

*This memo was prepared with assistance from Claude Opus 4.6 (Anthropic) for literature search, synthesis, and technical writing. All content was reviewed and verified by Al Irvine, R.P.Bio.*

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r packages, include=FALSE}
library(sf)
library(mapgl)
library(DBI)
library(RPostgres)
library(dplyr)
library(bcdata)
library(base64enc)
```

```{r db-connect, include=FALSE}
conn <- dbConnect(
  RPostgres::Postgres(),
  host = "localhost",
  port = 63333,
  dbname = "bcfishpass",
  user = "newgraph"
)
```

```{r data-bbox, include=FALSE}
# Square bbox centred on study area — south enough for Kenney Dam / Fraser Lake
bbox_wgs <- st_bbox(c(xmin = -127.5, ymin = 53, xmax = -122, ymax = 56.5), crs = 4326)
bbox_poly <- st_as_sfc(bbox_wgs)
bbox_3005 <- st_transform(bbox_poly, 3005)
```

```{r data-bec, include=FALSE}
# BEC zones from BC Data Catalogue — aggressive simplification for file size
# Dissolve BEC by zone to minimize geometry — subzone detail available on click
bec <- bcdc_query_geodata("f358a53b-ffde-4830-a325-a5a03ff672c3") |>
  filter(INTERSECTS(bbox_3005)) |>
  select(ZONE) |>
  collect() |>
  st_transform(4326) |>
  st_make_valid() |>
  st_intersection(bbox_poly) |>
  group_by(ZONE) |>
  summarise(geometry = st_union(geometry), .groups = "drop") |>
  st_simplify(dTolerance = 0.15, preserveTopology = TRUE)
```

```{r data-rivers, include=FALSE}
# River polygons (wide channels) — clipped to bbox, simplified
rivers_poly <- st_read(
  conn,
  query = "
    SELECT gnis_name_1 as name,
           ST_Transform(ST_Simplify(
             ST_Intersection(geom, ST_Transform(ST_MakeEnvelope(-127.5, 53, -122, 56.5, 4326), 3005)),
             500), 4326) as geom
    FROM whse_basemapping.fwa_rivers_poly
    WHERE gnis_name_1 IN (
      'Nechako River', 'Fraser River', 'Skeena River',
      'Bulkley River', 'Stuart River'
    )
    AND ST_Intersects(geom, ST_Transform(ST_MakeEnvelope(-127.5, 53, -122, 56.5, 4326), 3005))
  "
)

# Stream network lines — order >= 6 only, clipped, simplified
streams <- st_read(
  conn,
  query = "
    SELECT gnis_name as name, stream_order,
           ST_Transform(ST_Simplify(geom, 1000), 4326) as geom
    FROM whse_basemapping.fwa_stream_networks_sp
    WHERE stream_order >= 7
      AND ST_Intersects(
        geom,
        ST_Transform(ST_MakeEnvelope(-127.5, 53, -122, 56.5, 4326), 3005)
      )
  "
)
```

```{r data-towns, include=FALSE}
# Towns from BC Geographical Names
towns <- st_read(
  conn,
  query = "
    SELECT geographical_name as name, feature_type,
           ST_Transform(geom, 4326) as geom
    FROM whse_basemapping.gns_geographical_names_sp
    WHERE geographical_name IN (
      'Prince George', 'Mackenzie', 'Vanderhoof',
      'Burns Lake', 'Houston', 'Smithers', 'Fort St. James'
    )
    AND feature_type IN (
      'City', 'Town', 'Village (1)',
      'District Municipality (1)', 'District Municipality'
    )
  "
)
```

```{r data-dam, include=FALSE}
# Kenney Dam from bcfishpass dams table
kenney_dam <- st_read(
  conn,
  query = "
    SELECT dam_name_en as name, dam_use, owner,
           ST_Transform(geom, 4326) as geom
    FROM bcfishpass.dams
    WHERE dam_name_en = 'Kenney Dam'
  "
)
```

```{r data-lakes, include=FALSE}
# Major lakes — clipped to bbox, simplified, only large ones
lakes <- st_read(
  conn,
  query = "
    SELECT gnis_name_1 as name,
           ST_Transform(ST_Simplify(geom, 1000), 4326) as geom,
           area_ha
    FROM whse_basemapping.fwa_lakes_poly
    WHERE ST_Intersects(
        geom,
        ST_Transform(ST_MakeEnvelope(-127.5, 53, -122, 56.5, 4326), 3005)
      )
      AND area_ha > 2000
  "
)
```

```{r db-disconnect, include=FALSE}
dbDisconnect(conn)
```

```{r map-study-area, fig.cap="Study area showing the Nechako River source region (between Prince George and Kenney Dam) and proposed transfer destinations in the Mackenzie and Skeena basins. BEC zones are shown as semi-transparent fills. Data: BC Freshwater Atlas, BC Geographical Names, CABD dams, BEC Map (BC Data Catalogue).", fig.height=7}
# BEC zone colors — use a muted palette by zone
bec_colors <- c(
  "SBS" = "#8fbc8f",   # dark sea green
  "ESSF" = "#b0c4de",  # light steel blue
  "ICH" = "#deb887",   # burlywood
  "BWBS" = "#d8bfd8",  # thistle
  "CWH" = "#98fb98",   # pale green
  "MS" = "#f0e68c",    # khaki
  "SBPS" = "#c4d4a0",  # sage
  "SWB" = "#e6e6fa",   # lavender
  "AT" = "#f5f5dc",    # beige
  "MH" = "#a8d8a8",    # soft green
  "BG" = "#e8d8a0"     # soft tan
)

# Build match expression for BEC zone fill colors
bec_zones <- unique(bec$ZONE)
bec_expr <- c(list("match", list("get", "ZONE")))
for (z in bec_zones) {
  col <- ifelse(z %in% names(bec_colors), bec_colors[[z]], "#cccccc")
  bec_expr <- c(bec_expr, list(z, col))
}
bec_expr <- c(bec_expr, list("#cccccc"))

# Named streams for labels (order >= 7, major rivers only)
stream_labels <- streams |>
  filter(!is.na(name) & stream_order >= 7) |>
  group_by(name) |>
  summarise(geom = st_union(geom), .groups = "drop") |>
  st_point_on_surface()

maplibre(
  style = carto_style("positron"),
  bounds = c(-127.5, 53, -122, 56.5)
) |>
  # BEC zones
  add_fill_layer(
    id = "bec-zones",
    source = bec,
    fill_color = bec_expr,
    fill_opacity = 0.25,
    popup = "ZONE"
  ) |>
  add_line_layer(
    id = "bec-borders",
    source = bec,
    line_color = "#888888",
    line_width = 0.5,
    line_opacity = 0.4
  ) |>
  # Lakes
  add_fill_layer(
    id = "lakes",
    source = lakes,
    fill_color = "#c6ddf0",
    fill_opacity = 0.7
  ) |>
  # River polygons (wide channels)
  add_fill_layer(
    id = "rivers-poly",
    source = rivers_poly,
    fill_color = "#7ba7cc",
    fill_opacity = 0.7
  ) |>
  # Stream network lines
  add_line_layer(
    id = "streams",
    source = streams,
    line_color = "#7ba7cc",
    line_width = interpolate(
      column = "stream_order",
      values = c(5, 9),
      stops = c(0.5, 2.5)
    ),
    line_opacity = 0.6
  ) |>
  # River labels
  add_symbol_layer(
    id = "river-labels",
    source = stream_labels,
    text_field = get_column("name"),
    text_size = 11,
    text_color = "#1a5276",
    text_halo_color = "white",
    text_halo_width = 1.5,
    text_font = list("Open Sans Italic"),
    text_allow_overlap = FALSE
  ) |>
  # Towns
  add_circle_layer(
    id = "towns",
    source = towns,
    circle_radius = 5,
    circle_color = "#2c3e50",
    circle_stroke_color = "white",
    circle_stroke_width = 1.5
  ) |>
  add_symbol_layer(
    id = "town-labels",
    source = towns,
    text_field = get_column("name"),
    text_size = 12,
    text_color = "#2c3e50",
    text_halo_color = "white",
    text_halo_width = 1.5,
    text_font = list("Open Sans Bold"),
    text_offset = c(0, 1.2),
    text_allow_overlap = FALSE
  ) |>
  # Kenney Dam
  add_circle_layer(
    id = "kenney-dam",
    source = kenney_dam,
    circle_radius = 7,
    circle_color = "#c0392b",
    circle_stroke_color = "white",
    circle_stroke_width = 2
  ) |>
  add_symbol_layer(
    id = "dam-label",
    source = kenney_dam,
    text_field = get_column("name"),
    text_size = 11,
    text_color = "#c0392b",
    text_halo_color = "white",
    text_halo_width = 1.5,
    text_font = list("Open Sans Bold"),
    text_offset = c(0, 1.5)
  ) |>
  # Scale bar
  add_scale_control(
    position = "bottom-left",
    unit = "metric"
  ) |>
  # Navigation
  add_navigation_control(position = "top-right") |>
  # New Graph logo — upper left as north arrow stand-in
  add_control(
    html = paste0(
      '<img src="data:image/png;base64,',
      base64enc::base64encode("../../fig/logo_newgraph/BLACK/PNG/nge-icon_black.png"),
      '" style="height: 45px; opacity: 0.85;">'
    ),
    position = "top-left"
  )
```

# Question

Can black cottonwood (*Populus trichocarpa*) plugs collected along the Nechako River — between Prince George and Kenny Dam (~54°N) — be used for riparian restoration at two sites further north?

1. **Mackenzie basin** — 75--150 km north of Prince George (~55--56°N)
2. **Skeena / Neexdzii Kwah** — 120--150 km north of Kenny Dam (~54.5--55°N)

Both transfers move material 1--2° latitude northward, within the Sub-Boreal Spruce (SBS) biogeoclimatic zone, and within BC's interior where gene flow among cottonwood populations is relatively continuous.


# What the Literature Says

## Genetic structure: interior vs. coast

The most important finding for this question is that interior *P. trichocarpa* populations are genetically well-connected, unlike coastal populations where sharp ecotypic breaks exist across short distances. @xie_etal2012Ecotypicmode documented strong ecotypic differentiation among coastal populations in northern BC (Nass, Skeena, and Kitimat drainages), but this pattern reflects isolation in distinct coastal valleys separated by mountain barriers. Interior populations connected by broad river systems — like the Nechako, Fraser, and upper Skeena — show much higher gene flow and more gradual (clinal) trait variation.

Genome resequencing of range-wide samples found no evidence of restricted gene flow among interior BC drainages, with population structure following smooth isolation-by-distance gradients rather than drainage-specific breaks [@slavov_etal2012Genomeresequencing]. A landscape genomics analysis of 498 accessions across 25 drainages confirmed that interior populations are highly admixed with low differentiation — the sharp genetic boundaries documented on the coast do not exist in the interior plateau [@geraldes_etal2014LANDSCAPEGENOMICS].

## Clinal variation in adaptive traits

Cottonwood shows strong clinal variation in traits that matter for survival at new latitudes. @mckown_etal2014Geographicalenvironmental found that bud set timing, bud flush timing, growth rate, and leaf morphology all vary predictably with latitude across the species' range. These trait shifts are largely driven by photoperiod — specifically the *FLOWERING LOCUS T* genes (*FT1* and *FT2*) — rather than temperature alone.

@evans_etal2019PhenotypicGenomic confirmed that local adaptation in *P. trichocarpa* follows both latitudinal and elevational gradients, with genomic signatures of selection concentrated in genes controlling phenology and cold hardiness.

## Inter-basin gene flow: wind, pollen, and drainage divides

A key consideration for this transfer is that the source (Fraser/Nechako) and destinations (Mackenzie, Skeena) lie in different major river basins. However, multiple lines of evidence indicate that drainage divides in the interior are not barriers to gene flow in cottonwood.

Cottonwood seeds — equipped with cottony trichomes for wind dispersal — can travel up to 30 km under storm conditions [@nathan_etal2002Mechanismslongdistance]. The drainage divides between the Nechako, upper Skeena, and Parsnip/Pack (Mackenzie system) cross low-elevation passes on the interior plateau (~800--1000 m), not alpine barriers, making cross-basin wind dispersal physically plausible. A global analysis of 1,900+ tree populations confirmed that wind-connected populations are more genetically similar, with prevailing wind patterns shaping asymmetric gene flow and diversity gradients [@kling_ackerly2021Globalwind].

Pollen dispersal reinforces this connectivity. Direct paternity analysis in *P. trichocarpa* found pollen immigration rates of 32--54% from outside local populations, demonstrating that a large fraction of successful pollination originates beyond the immediate stand [@slavov_etal2009Extensivepollen]. Hydrochory (water-mediated dispersal) moves seeds downstream within drainages but cannot cross between basins — inter-basin connectivity depends on wind transport of seeds and pollen.

The available genomic evidence suggests that genetic structure in interior cottonwood follows smooth latitudinal gradients rather than drainage-specific breaks. Moving material between the Fraser, Mackenzie, and Skeena basins in the interior plateau appears consistent with natural gene flow patterns.

## What the clines mean for 1--2° transfers

The clinal patterns are gradual within the interior. Moving material 1--2° north means the plugs will encounter:

- **Slightly longer winter nights** — photoperiod at 55--56°N triggers bud set a few days earlier than at 54°N, so Nechako-source trees may set buds slightly later than local genotypes. In practice, this means a small increase in early-frost risk in the first few autumns.
- **Comparable growing-season temperatures** — within the SBS zone, mean growing-season temperatures are similar across this latitudinal band, especially given that climate warming is shifting thermal regimes northward.

The key question is whether the phenological mismatch is large enough to cause mortality. For a 1--2° shift within the interior, the literature suggests the risk is low — certainly lower than the large mortality events documented for coastal ecotype transfers [@xie_etal2012Ecotypicmode].


# BC Regulatory Context

## Climate-Based Seed Transfer (CBST)

BC's seed transfer system has moved from fixed geographic Seed Planning Zones to a climate-based approach that matches seedlots to planting sites by climate variables [@oneill_etal2008Assistedmigration; @oneill_etal2021Seedschange]. Under CBST, the question is whether the climate envelope at the collection site overlaps with the climate envelope at the planting site — and for Nechako-to-Mackenzie or Nechako-to-Skeena, there is substantial overlap within the SBS zone.

However, CBST was designed primarily for **reforestation obligations** under the Chief Forester's Standards for Seed Use. It is less clear whether CBST formally applies to **restoration plantings** outside of timber tenures. In practice, restoration practitioners in BC routinely move riparian material across similar distances without formal seed transfer approvals, but this is a gap in the regulatory framework [@oneill_etal2021Seedschange].

## Seed sourcing for restoration under climate change

The broader restoration literature supports "climate-adjusted provenancing" — intentionally sourcing material from slightly warmer or lower-latitude sites to pre-adapt plantings to anticipated climate conditions [@kramer_etal2015SeedSourcing; @pedrini_etal2022Seedsourcing]. Under this logic, Nechako-source material may actually be *better* suited to future conditions at the northern sites than strictly local genotypes, because the Nechako's current climate approximates the projected future climate at 55--56°N.


# Recommendations

1. **The transfer is likely appropriate.** Moving Nechako cottonwood plugs 1--2° north within the interior SBS zone is well within the range of natural gene flow and clinal variation. The genetic risk is low compared to cross-ecotype transfers (e.g., coastal to interior).

2. **Mix provenances where possible.** If local cuttings from the Mackenzie or Skeena sites are available, mixing them with Nechako-source plugs provides a genetic hedge. This composite provenancing approach is increasingly recommended for restoration under climate uncertainty [@kramer_etal2015SeedSourcing; @pedrini_etal2022Seedsourcing].

3. **Monitor fall phenology in the first 2--3 years.** The main risk is a slight delay in bud set relative to local genotypes. Watch for frost damage in September--October, particularly at the Mackenzie sites which are the furthest north.

4. **Document the provenance.** Record the exact collection location along the Nechako — closer to Prince George (~575 m elevation, SBSwk1) vs. closer to Kenny Dam (~850 m, SBSdk) matters because the elevation and BEC variant affect the magnitude of any climate mismatch at the receiving sites. This information is essential for interpreting monitoring results and informing future transfers.

# References
